plugins {
    id("java")
    alias(libs.plugins.shadow)
}

defaultTasks('build')

subprojects {
    apply(plugin: 'java')
//    apply(plugin: libs.plugins.spotless.get().pluginId)

    sourceCompatibility = 1.8
    targetCompatibility = 1.8

    tasks.withType(JavaCompile).configureEach {
        options.encoding = 'UTF-8'
    }

    repositories {
        mavenLocal()
        mavenCentral()

        // NeuralNexus
        maven {
            name = "NeuralNexus"
            url = "https://maven.neuralnexus.dev/releases"
        }

        // NeuralNexus Mirror
        maven {
            name = 'NeuralNexus Mirror'
            url = 'https://maven.neuralnexus.dev/mirror'
        }

        // Minecraft
        maven {
            name = "minecraft-repo"
            url = "https://libraries.minecraft.net/"
        }
    }

    dependencies {
        compileOnly("org.jetbrains:annotations:24.1.0")
        compileOnly("dev.neuralnexus:conditional-mixins:0.1.1")
    }

//    spotless {
//        format 'misc', {
//            target '*.gradle', '.gitattributes', '.gitignore'
//
//            trimTrailingWhitespace()
//            indentWithSpaces()
//            endWithNewline()
//        }
//        java {
//            importOrder()
//            removeUnusedImports()
//            cleanthat()
//            googleJavaFormat('1.17.0').aosp().formatJavadoc(true).reorderImports(true)
//            formatAnnotations()
//            licenseHeader """/**
// * Copyright (c) \$YEAR Dylan Sperrer - dylan@sperrer.ca
// * The project is Licensed under <a href="https://github.com/Tater-Certified/Overseer/blob/dev/LICENSE">MIT</a>
// */
//"""
//        }
//    }
//
//    tasks.build.dependsOn(spotlessApply)
//    tasks.findByName('shadowJar')?.dependsOn(spotlessApply)
//    tasks.findByName('remapShadowJar')?.dependsOn(spotlessApply)
}

repositories {
    mavenLocal()
    mavenCentral()

    // NeuralNexus
    maven {
        name = "NeuralNexus"
        url = "https://maven.neuralnexus.dev/releases"
    }
}

dependencies {
    implementation("dev.neuralnexus:conditional-mixins:0.1.1")
    implementation(project(":common"))
    implementation(project(":neoforge:neoforge-1.20.2"))
    implementation(project(":neoforge:neoforge-1.21.1"))
}

shadowJar {
    archiveFileName = "pcf-fulltest-${version}.jar"
}
